<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>sql_page â€“ DS 250</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Images/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4e2bce2a319ac43a0f9d3679f4652dd8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-87b4c9ac1131d2f8bea9da19218cde74.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DS 250</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../setup.html"> 
<span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../materials.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workbooks.html"> 
<span class="menu-text">Workbooks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Book Time with Us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus/syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../skill_builders.html"> 
<span class="menu-text">Skill Builders</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../faq.html"> 
<span class="menu-text">FAQ</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-sql-is-important" id="toc-why-sql-is-important" class="nav-link active" data-scroll-target="#why-sql-is-important">Why SQL is Important</a></li>
  <li><a href="#basic-sql-concepts" id="toc-basic-sql-concepts" class="nav-link" data-scroll-target="#basic-sql-concepts">Basic SQL Concepts</a></li>
  <li><a href="#basic-sql-concepts-1" id="toc-basic-sql-concepts-1" class="nav-link" data-scroll-target="#basic-sql-concepts-1">Basic SQL Concepts</a>
  <ul class="collapse">
  <li><a href="#select-and-from" id="toc-select-and-from" class="nav-link" data-scroll-target="#select-and-from">SELECT and FROM</a></li>
  <li><a href="#select-exclude-and-rename" id="toc-select-exclude-and-rename" class="nav-link" data-scroll-target="#select-exclude-and-rename">SELECT EXCLUDE and RENAME</a></li>
  <li><a href="#limit-and-offset" id="toc-limit-and-offset" class="nav-link" data-scroll-target="#limit-and-offset">LIMIT and OFFSET</a></li>
  <li><a href="#order-by" id="toc-order-by" class="nav-link" data-scroll-target="#order-by">ORDER BY</a></li>
  <li><a href="#and-or-not" id="toc-and-or-not" class="nav-link" data-scroll-target="#and-or-not">AND, OR, NOT</a></li>
  <li><a href="#numeric-operations" id="toc-numeric-operations" class="nav-link" data-scroll-target="#numeric-operations">Numeric Operations</a></li>
  <li><a href="#like-and-not-like" id="toc-like-and-not-like" class="nav-link" data-scroll-target="#like-and-not-like">LIKE and NOT LIKE</a></li>
  <li><a href="#between" id="toc-between" class="nav-link" data-scroll-target="#between">BETWEEN</a></li>
  <li><a href="#offset" id="toc-offset" class="nav-link" data-scroll-target="#offset">OFFSET</a></li>
  </ul></li>
  <li><a href="#intermediate-sql-concepts" id="toc-intermediate-sql-concepts" class="nav-link" data-scroll-target="#intermediate-sql-concepts">Intermediate SQL Concepts</a>
  <ul class="collapse">
  <li><a href="#joins" id="toc-joins" class="nav-link" data-scroll-target="#joins">Joins</a></li>
  <li><a href="#cast" id="toc-cast" class="nav-link" data-scroll-target="#cast">CAST</a></li>
  <li><a href="#aggregations" id="toc-aggregations" class="nav-link" data-scroll-target="#aggregations">Aggregations</a></li>
  <li><a href="#group-by-and-having" id="toc-group-by-and-having" class="nav-link" data-scroll-target="#group-by-and-having">GROUP BY and HAVING</a></li>
  <li><a href="#union-intersect-minus" id="toc-union-intersect-minus" class="nav-link" data-scroll-target="#union-intersect-minus">UNION, INTERSECT, MINUS</a></li>
  <li><a href="#position" id="toc-position" class="nav-link" data-scroll-target="#position">POSITION</a></li>
  <li><a href="#case" id="toc-case" class="nav-link" data-scroll-target="#case">CASE</a></li>
  </ul></li>
  <li><a href="#joins-1" id="toc-joins-1" class="nav-link" data-scroll-target="#joins-1">Joins</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  </ul></li>
  <li><a href="#concatenate" id="toc-concatenate" class="nav-link" data-scroll-target="#concatenate">Concatenate</a>
  <ul class="collapse">
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  <li><a href="#merge" id="toc-merge" class="nav-link" data-scroll-target="#merge">Merge</a></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1">Exercise</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2">Exercise</a></li>
  </ul></li>
  <li><a href="#introduction-to-sql-joins" id="toc-introduction-to-sql-joins" class="nav-link" data-scroll-target="#introduction-to-sql-joins">Introduction to SQL Joins</a></li>
  <li><a href="#types-of-joins" id="toc-types-of-joins" class="nav-link" data-scroll-target="#types-of-joins">Types of Joins</a>
  <ul class="collapse">
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join">INNER JOIN</a></li>
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join">LEFT JOIN</a></li>
  <li><a href="#right-join" id="toc-right-join" class="nav-link" data-scroll-target="#right-join">RIGHT JOIN</a></li>
  <li><a href="#full-join" id="toc-full-join" class="nav-link" data-scroll-target="#full-join">FULL JOIN</a></li>
  </ul></li>
  <li><a href="#example-data-frames" id="toc-example-data-frames" class="nav-link" data-scroll-target="#example-data-frames">Example Data Frames</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/byuistats/DS250-Course/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Structured Query Language (SQL) is a powerful tool for managing and manipulating relational databases. It is essential for data scientists, analysts, and anyone working with large datasets. This chapter will explore the importance of SQL, its applications, and provide example code format to illustrate its utility.</p>
<section id="why-sql-is-important" class="level2">
<h2 class="anchored" data-anchor-id="why-sql-is-important">Why SQL is Important</h2>
<ol type="1">
<li><strong>Data Management</strong>: SQL allows for efficient management of large volumes of data. It provides the means to create, read, update, and delete data in a relational database.</li>
<li><strong>Data Retrieval</strong>: With SQL, you can perform complex queries to retrieve specific data from one or more tables, making it easier to analyze and draw insights.</li>
<li><strong>Data Manipulation</strong>: SQL enables the manipulation of data through operations such as sorting, filtering, and aggregating. This is crucial for data cleaning and preprocessing.</li>
<li><strong>Data Integration</strong>: SQL supports the integration of data from different sources, allowing for comprehensive data analysis.</li>
<li><strong>Standardization</strong>: SQL is a standardized language used by most relational database management systems (RDBMS), making it a versatile and essential skill for professionals in the field.</li>
</ol>
</section>
<section id="basic-sql-concepts" class="level2">
<h2 class="anchored" data-anchor-id="basic-sql-concepts">Basic SQL Concepts</h2>
<div id="1366bb6a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="basic-sql-concepts-1" class="level2">
<h2 class="anchored" data-anchor-id="basic-sql-concepts-1">Basic SQL Concepts</h2>
<p>To illustrate the following SQL concepts, we will use the <code>employees</code> table with the following data:</p>
<p><strong>Table: employees</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
<td>55000</td>
</tr>
<tr class="even">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>HR</td>
<td>75000</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
<td>65000</td>
</tr>
<tr class="even">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
<td>69000</td>
</tr>
<tr class="even">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
<td>64000</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>HR</td>
<td>61000</td>
</tr>
<tr class="odd">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>IT</td>
<td>76000</td>
</tr>
<tr class="even">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
<tr class="odd">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>HR</td>
<td>63000</td>
</tr>
<tr class="even">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
<td>81000</td>
</tr>
</tbody>
</table>
<section id="select-and-from" class="level3">
<h3 class="anchored" data-anchor-id="select-and-from">SELECT and FROM</h3>
<p>The <code>SELECT</code> statement is used to fetch data from a database, and the <code>FROM</code> clause specifies the table.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Selecting all columns from a table</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
<td>55000</td>
</tr>
<tr class="even">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>HR</td>
<td>75000</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
<td>65000</td>
</tr>
<tr class="even">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
<td>69000</td>
</tr>
<tr class="even">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
<td>64000</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>HR</td>
<td>61000</td>
</tr>
<tr class="odd">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>IT</td>
<td>76000</td>
</tr>
<tr class="even">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
<tr class="odd">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>HR</td>
<td>63000</td>
</tr>
<tr class="even">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
<td>81000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Selecting specific columns</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  first_name, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  last_name, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  salary </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>60000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>55000</td>
</tr>
<tr class="even">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>75000</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>65000</td>
</tr>
<tr class="even">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>62000</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>77000</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>53000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>69000</td>
</tr>
<tr class="even">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>50000</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>64000</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>68000</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>61000</td>
</tr>
<tr class="odd">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>76000</td>
</tr>
<tr class="even">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>57000</td>
</tr>
<tr class="odd">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>63000</td>
</tr>
<tr class="even">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>81000</td>
</tr>
</tbody>
</table>
</section>
<section id="select-exclude-and-rename" class="level3">
<h3 class="anchored" data-anchor-id="select-exclude-and-rename">SELECT EXCLUDE and RENAME</h3>
<p>You can exclude columns using <code>SELECT</code> and rename them for clarity.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Selecting all but one column</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>EXCLUDE </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  salary </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
</tr>
<tr class="even">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>HR</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
</tr>
<tr class="even">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
</tr>
<tr class="even">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>HR</td>
</tr>
<tr class="odd">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>IT</td>
</tr>
<tr class="even">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
</tr>
<tr class="odd">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>HR</td>
</tr>
<tr class="even">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Renaming columns</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  first_name <span class="kw">AS</span> fname, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  last_name <span class="kw">AS</span> lname </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>fname</th>
<th>lname</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>Smith</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>Johnson</td>
</tr>
<tr class="odd">
<td>Charlie</td>
<td>Lee</td>
</tr>
<tr class="even">
<td>David</td>
<td>Kim</td>
</tr>
<tr class="odd">
<td>Eva</td>
<td>Brown</td>
</tr>
<tr class="even">
<td>Frank</td>
<td>Wilson</td>
</tr>
<tr class="odd">
<td>Grace</td>
<td>Taylor</td>
</tr>
<tr class="even">
<td>Henry</td>
<td>Anderson</td>
</tr>
<tr class="odd">
<td>Irene</td>
<td>Thomas</td>
</tr>
<tr class="even">
<td>Jack</td>
<td>White</td>
</tr>
<tr class="odd">
<td>Karen</td>
<td>Harris</td>
</tr>
<tr class="even">
<td>Leo</td>
<td>Martin</td>
</tr>
<tr class="odd">
<td>Mia</td>
<td>Jackson</td>
</tr>
<tr class="even">
<td>Noah</td>
<td>Lee</td>
</tr>
<tr class="odd">
<td>Olivia</td>
<td>Perez</td>
</tr>
<tr class="even">
<td>Paul</td>
<td>Young</td>
</tr>
<tr class="odd">
<td>Quinn</td>
<td>King</td>
</tr>
<tr class="even">
<td>Rachel</td>
<td>Scott</td>
</tr>
<tr class="odd">
<td>Sam</td>
<td>Green</td>
</tr>
<tr class="even">
<td>Tina</td>
<td>Adams</td>
</tr>
</tbody>
</table>
</section>
<section id="limit-and-offset" class="level3">
<h3 class="anchored" data-anchor-id="limit-and-offset">LIMIT and OFFSET</h3>
<p>The <code>LIMIT</code> clause restricts the number of rows returned, and <code>OFFSET</code> skips rows before beginning to return rows.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Limiting the number of rows returned</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>;</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
<td>55000</td>
</tr>
<tr class="even">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>HR</td>
<td>75000</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
<td>65000</td>
</tr>
<tr class="even">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Skipping rows</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">10</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>OFFSET <span class="dv">5</span>;</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="even">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="odd">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="even">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="even">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
<td>69000</td>
</tr>
<tr class="odd">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
<tr class="even">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
<td>64000</td>
</tr>
<tr class="odd">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
<td>72000</td>
</tr>
<tr class="even">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
</tbody>
</table>
</section>
<section id="order-by" class="level3">
<h3 class="anchored" data-anchor-id="order-by">ORDER BY</h3>
<p>The <code>ORDER BY</code> clause sorts the result set.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Sorting the result set by salary in ascending order</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span>  </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  salary;</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
<tr class="even">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
<td>55000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
<tr class="even">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>HR</td>
<td>63000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="even">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
<td>64000</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
<td>65000</td>
</tr>
<tr class="even">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
<td>69000</td>
</tr>
<tr class="odd">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
<tr class="even">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
<tr class="odd">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>IT</td>
<td>76000</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="odd">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>HR</td>
<td>75000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
<td>81000</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>HR</td>
<td>61000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Sorting in descending order</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  salary <span class="kw">DESC</span>;</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
<td>81000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="even">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>IT</td>
<td>76000</td>
</tr>
<tr class="odd">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>HR</td>
<td>75000</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="even">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
<td>69000</td>
</tr>
<tr class="even">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
<td>65000</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
<td>64000</td>
</tr>
<tr class="even">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>HR</td>
<td>63000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>HR</td>
<td>61000</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
<td>55000</td>
</tr>
<tr class="even">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="odd">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
<tr class="even">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
</tbody>
</table>
</section>
<section id="and-or-not" class="level3">
<h3 class="anchored" data-anchor-id="and-or-not">AND, OR, NOT</h3>
<p>Logical operators <code>filter</code> records based on multiple conditions.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Using AND, OR, NOT operators</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  department <span class="op">=</span> <span class="st">'Sales'</span> <span class="kw">AND</span> salary <span class="op">&gt;</span> <span class="dv">50000</span>;</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="even">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
<tr class="odd">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
</tbody>
</table>
</section>
<section id="numeric-operations" class="level3">
<h3 class="anchored" data-anchor-id="numeric-operations">Numeric Operations</h3>
<p>Perform <code>arithmetic</code> operations in SQL.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Calculating a new column</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  first_name, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  last_name, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  salary, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  salary <span class="op">*</span> <span class="fl">1.1</span> <span class="kw">AS</span> new_salary </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>first_name</th>
<th>last_name</th>
<th>salary</th>
<th>new_salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>Smith</td>
<td>60000</td>
<td>66000.0</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>Johnson</td>
<td>80000</td>
<td>88000.0</td>
</tr>
<tr class="odd">
<td>Charlie</td>
<td>Lee</td>
<td>55000</td>
<td>60500.0</td>
</tr>
<tr class="even">
<td>David</td>
<td>Kim</td>
<td>75000</td>
<td>82500.0</td>
</tr>
<tr class="odd">
<td>Eva</td>
<td>Brown</td>
<td>65000</td>
<td>71500.0</td>
</tr>
<tr class="even">
<td>Frank</td>
<td>Wilson</td>
<td>70000</td>
<td>77000.0</td>
</tr>
<tr class="odd">
<td>Grace</td>
<td>Taylor</td>
<td>62000</td>
<td>68200.0</td>
</tr>
<tr class="even">
<td>Henry</td>
<td>Anderson</td>
<td>77000</td>
<td>84700.0</td>
</tr>
<tr class="odd">
<td>Irene</td>
<td>Thomas</td>
<td>53000</td>
<td>58300.0</td>
</tr>
<tr class="even">
<td>Jack</td>
<td>White</td>
<td>58000</td>
<td>63800.0</td>
</tr>
<tr class="odd">
<td>Karen</td>
<td>Harris</td>
<td>69000</td>
<td>75900.0</td>
</tr>
<tr class="even">
<td>Leo</td>
<td>Martin</td>
<td>50000</td>
<td>55000.0</td>
</tr>
<tr class="odd">
<td>Mia</td>
<td>Jackson</td>
<td>64000</td>
<td>70400.0</td>
</tr>
<tr class="even">
<td>Noah</td>
<td>Lee</td>
<td>72000</td>
<td>79200.0</td>
</tr>
<tr class="odd">
<td>Olivia</td>
<td>Perez</td>
<td>68000</td>
<td>74800.0</td>
</tr>
<tr class="even">
<td>Paul</td>
<td>Young</td>
<td>61000</td>
<td>67100.0</td>
</tr>
<tr class="odd">
<td>Quinn</td>
<td>King</td>
<td>76000</td>
<td>83600.0</td>
</tr>
<tr class="even">
<td>Rachel</td>
<td>Scott</td>
<td>57000</td>
<td>62700.0</td>
</tr>
<tr class="odd">
<td>Sam</td>
<td>Green</td>
<td>63000</td>
<td>69300.0</td>
</tr>
<tr class="even">
<td>Tina</td>
<td>Adams</td>
<td>81000</td>
<td>89100.0</td>
</tr>
</tbody>
</table>
</section>
<section id="like-and-not-like" class="level3">
<h3 class="anchored" data-anchor-id="like-and-not-like">LIKE and NOT LIKE</h3>
<p>Pattern matching using <code>LIKE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pattern matching</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  last_name </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LIKE</span> <span class="st">'S%'</span>;</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
<tr class="even">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
</tbody>
</table>
</section>
<section id="between" class="level3">
<h3 class="anchored" data-anchor-id="between">BETWEEN</h3>
<p>Range filtering using <code>BETWEEN</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Filtering within a range</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  salary <span class="kw">BETWEEN</span> <span class="dv">40000</span> <span class="kw">AND</span> <span class="dv">60000</span>;</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
<tr class="even">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
<td>55000</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
<td>60000</td>
</tr>
</tbody>
</table>
</section>
<section id="offset" class="level3">
<h3 class="anchored" data-anchor-id="offset">OFFSET</h3>
<p><code>Skip</code> a specific number of rows before starting to return rows.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Skipping the first 5 rows</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  employees </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>OFFSET <span class="dv">5</span>;</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
<td>70000</td>
</tr>
<tr class="even">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
<td>62000</td>
</tr>
<tr class="odd">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
<td>77000</td>
</tr>
<tr class="even">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
<td>53000</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>HR</td>
<td>58000</td>
</tr>
<tr class="even">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
<td>69000</td>
</tr>
<tr class="odd">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
<td>50000</td>
</tr>
<tr class="even">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
<td>64000</td>
</tr>
<tr class="odd">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
<td>72000</td>
</tr>
<tr class="even">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
<td>68000</td>
</tr>
<tr class="odd">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>HR</td>
<td>61000</td>
</tr>
<tr class="even">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>IT</td>
<td>76000</td>
</tr>
<tr class="odd">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
<td>57000</td>
</tr>
<tr class="even">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>HR</td>
<td>63000</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
<td>81000</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="intermediate-sql-concepts" class="level2">
<h2 class="anchored" data-anchor-id="intermediate-sql-concepts">Intermediate SQL Concepts</h2>
<section id="joins" class="level3">
<h3 class="anchored" data-anchor-id="joins">Joins</h3>
<p><strong>Table: employees</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>id</th>
<th>first_name</th>
<th>last_name</th>
<th>department_id</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Alice</td>
<td>Smith</td>
<td>1</td>
<td>60000</td>
</tr>
<tr class="even">
<td>2</td>
<td>Bob</td>
<td>Johnson</td>
<td>2</td>
<td>80000</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Charlie</td>
<td>Lee</td>
<td>3</td>
<td>55000</td>
</tr>
<tr class="even">
<td>4</td>
<td>David</td>
<td>Kim</td>
<td>1</td>
<td>75000</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eva</td>
<td>Brown</td>
<td>2</td>
<td>65000</td>
</tr>
<tr class="even">
<td>6</td>
<td>Frank</td>
<td>Wilson</td>
<td>3</td>
<td>70000</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Grace</td>
<td>Taylor</td>
<td>1</td>
<td>62000</td>
</tr>
<tr class="even">
<td>8</td>
<td>Henry</td>
<td>Anderson</td>
<td>2</td>
<td>77000</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Irene</td>
<td>Thomas</td>
<td>3</td>
<td>53000</td>
</tr>
<tr class="even">
<td>10</td>
<td>Jack</td>
<td>White</td>
<td>1</td>
<td>58000</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Karen</td>
<td>Harris</td>
<td>2</td>
<td>69000</td>
</tr>
<tr class="even">
<td>12</td>
<td>Leo</td>
<td>Martin</td>
<td>3</td>
<td>50000</td>
</tr>
<tr class="odd">
<td>13</td>
<td>Mia</td>
<td>Jackson</td>
<td>1</td>
<td>64000</td>
</tr>
<tr class="even">
<td>14</td>
<td>Noah</td>
<td>Lee</td>
<td>2</td>
<td>72000</td>
</tr>
<tr class="odd">
<td>15</td>
<td>Olivia</td>
<td>Perez</td>
<td>3</td>
<td>68000</td>
</tr>
<tr class="even">
<td>16</td>
<td>Paul</td>
<td>Young</td>
<td>1</td>
<td>61000</td>
</tr>
<tr class="odd">
<td>17</td>
<td>Quinn</td>
<td>King</td>
<td>2</td>
<td>76000</td>
</tr>
<tr class="even">
<td>18</td>
<td>Rachel</td>
<td>Scott</td>
<td>3</td>
<td>57000</td>
</tr>
<tr class="odd">
<td>19</td>
<td>Sam</td>
<td>Green</td>
<td>1</td>
<td>63000</td>
</tr>
<tr class="even">
<td>20</td>
<td>Tina</td>
<td>Adams</td>
<td>2</td>
<td>81000</td>
</tr>
</tbody>
</table>
<p><strong>Table: departments</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>department_id</th>
<th>department_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>HR</td>
</tr>
<tr class="even">
<td>2</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Sales</td>
</tr>
</tbody>
</table>
<p>Combine rows from two or more tables based on a related column.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Inner join example</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  employees.first_name, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    employees.last_name, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    departments.department_name</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  employees</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  departments <span class="kw">ON</span> employees.department_id <span class="op">=</span> departments.department_id;</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>first_name</th>
<th>last_name</th>
<th>department_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>Smith</td>
<td>HR</td>
</tr>
<tr class="even">
<td>David</td>
<td>Kim</td>
<td>HR</td>
</tr>
<tr class="odd">
<td>Grace</td>
<td>Taylor</td>
<td>HR</td>
</tr>
<tr class="even">
<td>Jack</td>
<td>White</td>
<td>HR</td>
</tr>
<tr class="odd">
<td>Mia</td>
<td>Jackson</td>
<td>HR</td>
</tr>
<tr class="even">
<td>Paul</td>
<td>Young</td>
<td>HR</td>
</tr>
<tr class="odd">
<td>Sam</td>
<td>Green</td>
<td>HR</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>Johnson</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>Eva</td>
<td>Brown</td>
<td>IT</td>
</tr>
<tr class="even">
<td>Henry</td>
<td>Anderson</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>Karen</td>
<td>Harris</td>
<td>IT</td>
</tr>
<tr class="even">
<td>Noah</td>
<td>Lee</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>Quinn</td>
<td>King</td>
<td>IT</td>
</tr>
<tr class="even">
<td>Tina</td>
<td>Adams</td>
<td>IT</td>
</tr>
<tr class="odd">
<td>Charlie</td>
<td>Lee</td>
<td>Sales</td>
</tr>
<tr class="even">
<td>Frank</td>
<td>Wilson</td>
<td>Sales</td>
</tr>
<tr class="odd">
<td>Irene</td>
<td>Thomas</td>
<td>Sales</td>
</tr>
<tr class="even">
<td>Leo</td>
<td>Martin</td>
<td>Sales</td>
</tr>
<tr class="odd">
<td>Olivia</td>
<td>Perez</td>
<td>Sales</td>
</tr>
<tr class="even">
<td>Rachel</td>
<td>Scott</td>
<td>Sales</td>
</tr>
</tbody>
</table>
</section>
<section id="cast" class="level3">
<h3 class="anchored" data-anchor-id="cast">CAST</h3>
<p>Convert <code>data</code> from one type to another.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Casting a column</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">CAST</span>(salary <span class="kw">AS</span> <span class="dt">DECIMAL</span>(<span class="dv">10</span>, <span class="dv">2</span>)) </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>60000.00</td>
</tr>
<tr class="even">
<td>80000.00</td>
</tr>
<tr class="odd">
<td>55000.00</td>
</tr>
<tr class="even">
<td>75000.00</td>
</tr>
<tr class="odd">
<td>65000.00</td>
</tr>
<tr class="even">
<td>70000.00</td>
</tr>
<tr class="odd">
<td>62000.00</td>
</tr>
<tr class="even">
<td>77000.00</td>
</tr>
<tr class="odd">
<td>53000.00</td>
</tr>
<tr class="even">
<td>58000.00</td>
</tr>
<tr class="odd">
<td>69000.00</td>
</tr>
<tr class="even">
<td>50000.00</td>
</tr>
<tr class="odd">
<td>64000.00</td>
</tr>
<tr class="even">
<td>72000.00</td>
</tr>
<tr class="odd">
<td>68000.00</td>
</tr>
<tr class="even">
<td>61000.00</td>
</tr>
<tr class="odd">
<td>76000.00</td>
</tr>
<tr class="even">
<td>57000.00</td>
</tr>
<tr class="odd">
<td>63000.00</td>
</tr>
<tr class="even">
<td>81000.00</td>
</tr>
</tbody>
</table>
</section>
<section id="aggregations" class="level3">
<h3 class="anchored" data-anchor-id="aggregations">Aggregations</h3>
<p>Perform <code>calculations</code> on a set of values.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Using aggregation functions</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  department_id, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">COUNT</span>(employee_id) <span class="kw">AS</span> num_employees</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  employees</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  department_id;</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>department_id</th>
<th>num_employees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>7</td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
</tr>
</tbody>
</table>
</section>
<section id="group-by-and-having" class="level3">
<h3 class="anchored" data-anchor-id="group-by-and-having">GROUP BY and HAVING</h3>
<p><code>Group</code> rows that have the same values and <code>filter</code> groups.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Grouping rows and filtering groups</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  department_id,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">COUNT</span>(employee_id) <span class="kw">AS</span> num_employees</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  employees</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  department_id</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">COUNT</span>(employee_id) <span class="op">&gt;</span> <span class="dv">5</span>;</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>department_id</th>
<th>num_employees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>7</td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
</tr>
</tbody>
</table>
</section>
<section id="union-intersect-minus" class="level3">
<h3 class="anchored" data-anchor-id="union-intersect-minus">UNION, INTERSECT, MINUS</h3>
<p>Combine result sets</p>
<p><strong>Table: managers</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>manager_id</th>
<th>first_name</th>
<th>last_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Michael</td>
<td>Brown</td>
</tr>
<tr class="even">
<td>2</td>
<td>Sarah</td>
<td>Johnson</td>
</tr>
<tr class="odd">
<td>3</td>
<td>John</td>
<td>Lee</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Union example</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  first_name </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  employees</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  first_name</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>   managers;</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>first_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
</tr>
<tr class="even">
<td>Bob</td>
</tr>
<tr class="odd">
<td>Charlie</td>
</tr>
<tr class="even">
<td>David</td>
</tr>
<tr class="odd">
<td>Eva</td>
</tr>
<tr class="even">
<td>Frank</td>
</tr>
<tr class="odd">
<td>Grace</td>
</tr>
<tr class="even">
<td>Henry</td>
</tr>
<tr class="odd">
<td>Irene</td>
</tr>
<tr class="even">
<td>Jack</td>
</tr>
<tr class="odd">
<td>Karen</td>
</tr>
<tr class="even">
<td>Leo</td>
</tr>
<tr class="odd">
<td>Mia</td>
</tr>
<tr class="even">
<td>Noah</td>
</tr>
<tr class="odd">
<td>Olivia</td>
</tr>
<tr class="even">
<td>Paul</td>
</tr>
<tr class="odd">
<td>Quinn</td>
</tr>
<tr class="even">
<td>Rachel</td>
</tr>
<tr class="odd">
<td>Sam</td>
</tr>
<tr class="even">
<td>Tina</td>
</tr>
<tr class="odd">
<td>Michael</td>
</tr>
<tr class="even">
<td>Sarah</td>
</tr>
<tr class="odd">
<td>John</td>
</tr>
</tbody>
</table>
</section>
<section id="position" class="level3">
<h3 class="anchored" data-anchor-id="position">POSITION</h3>
<p><code>Find</code> the position of a <code>substring</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Finding substring position</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  POSITION(<span class="st">'e'</span> <span class="kw">IN</span> first_name) </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>0</td>
</tr>
<tr class="odd">
<td>4</td>
</tr>
<tr class="even">
<td>0</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>3</td>
</tr>
<tr class="odd">
<td>2</td>
</tr>
<tr class="even">
<td>0</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>3</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>0</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>0</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
</tr>
<tr class="odd">
<td>0</td>
</tr>
<tr class="even">
<td>0</td>
</tr>
</tbody>
</table>
</section>
<section id="case" class="level3">
<h3 class="anchored" data-anchor-id="case">CASE</h3>
<p><code>Conditional</code> logic in `SQL.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Using CASE statements</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  first_name, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  last_name,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>       <span class="cf">CASE</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="cf">WHEN</span> salary <span class="op">&gt;</span> <span class="dv">60000</span> <span class="cf">THEN</span> <span class="st">'High'</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>         <span class="cf">WHEN</span> salary <span class="kw">BETWEEN</span> <span class="dv">40000</span> <span class="kw">AND</span> <span class="dv">60000</span> <span class="cf">THEN</span> <span class="st">'Medium'</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>         <span class="cf">ELSE</span> <span class="st">'Low'</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>       <span class="cf">END</span> <span class="kw">AS</span> salary_category</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  employees;</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>first_name</th>
<th>last_name</th>
<th>salary_category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>Smith</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>Johnson</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Charlie</td>
<td>Lee</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>David</td>
<td>Kim</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Eva</td>
<td>Brown</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Frank</td>
<td>Wilson</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Grace</td>
<td>Taylor</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Henry</td>
<td>Anderson</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Irene</td>
<td>Thomas</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Jack</td>
<td>White</td>
<td>Medium</td>
</tr>
<tr class="odd">
<td>Karen</td>
<td>Harris</td>
<td>High</td>
</tr>
<tr class="even">
<td>Leo</td>
<td>Martin</td>
<td>Medium</td>
</tr>
<tr class="odd">
<td>Mia</td>
<td>Jackson</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Noah</td>
<td>Lee</td>
<td>High</td>
</tr>
<tr class="odd">
<td>Olivia</td>
<td>Perez</td>
<td>High</td>
</tr>
<tr class="even">
<td>Paul</td>
<td>Young</td>
<td>Medium</td>
</tr>
<tr class="odd">
<td>Quinn</td>
<td>King</td>
<td>High</td>
</tr>
<tr class="even">
<td>Rachel</td>
<td>Scott</td>
<td>Medium</td>
</tr>
<tr class="odd">
<td>Sam</td>
<td>Green</td>
<td>Medium</td>
</tr>
<tr class="even">
<td>Tina</td>
<td>Adams</td>
<td>High</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="joins-1" class="level1">
<h1>Joins</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Itâ€™s rare that a data analysis involves only a single data frame. Typically you have many data frames, and you must <em>join</em> them together to answer the questions that youâ€™re interested in.</p>
<p><strong>pandas</strong> has a really rich set of options for combining one or more data frames, with the two most important being concatenate and merge. Some of the examples in this chapter show you how to join a pair of data frames. Fortunately this is enough, since you can combine three data frames by combining two pairs.</p>
<div id="c5dff871" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove cell</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib_inline.backend_inline</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot settings</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"https://github.com/aeturrell/python4DS/raw/main/plot_style.txt"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>matplotlib_inline.backend_inline.set_matplotlib_formats(<span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<p>This chapter will use the <strong>pandas</strong> data analysis package.</p>
</section>
</section>
<section id="concatenate" class="level2">
<h2 class="anchored" data-anchor-id="concatenate">Concatenate</h2>
<p>If you have two or more data frames with the same index or the same columns, you can glue them together into a single data frame using <code>pd.concat()</code>.</p>
<p><img src="https://pandas.pydata.org/docs/_images/08_concat_row.svg" class="img-fluid"></p>
<p>For the same columns, pass <code>axis=0</code> to glue the index together; for the same index, pass <code>axis=1</code> to glue the columns together. The concatenate function will typically be used on a list of data frames.</p>
<p>If you want to track where the original data came from in the final data frame, use the <code>keys</code> keyword.</p>
<p>Hereâ€™s an example using data on two different statesâ€™ populations that also makes uses of the <code>keys</code> option:</p>
<div id="381b07b9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>base_url <span class="op">=</span> <span class="st">"http://www.stata-press.com/data/r14/"</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>state_codes <span class="op">=</span> [<span class="st">"ca"</span>, <span class="st">"il"</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>end_url <span class="op">=</span> <span class="st">"pop.dta"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> {<span class="st">'User-Agent'</span>: <span class="st">'Mozilla/5.0'</span>}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fetch_data(url):</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    req <span class="op">=</span> urllib.request.Request(url, headers<span class="op">=</span>headers)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> urllib.request.urlopen(req) <span class="im">as</span> response:</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.read_stata(response)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This grabs the two data frames, one for each state</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>list_of_state_dfs <span class="op">=</span> [fetch_data(base_url <span class="op">+</span> state <span class="op">+</span> end_url) <span class="cf">for</span> state <span class="kw">in</span> state_codes]</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show example of first entry in list of data frames</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(list_of_state_dfs[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        county      pop
0  Los Angeles  9878554
1       Orange  2997033
2      Ventura   798364</code></pre>
</div>
</div>
<div id="d94c6e02" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the list of data frames</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(list_of_state_dfs, keys<span class="op">=</span>state_codes, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>keys</code> argument is optional, but is useful for keeping track of origin data frames within the merged data frame.</p>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<p>Concatenate the follow two data frames:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame([[<span class="st">'a'</span>, <span class="dv">1</span>], [<span class="st">'b'</span>, <span class="dv">2</span>]],</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                   columns<span class="op">=</span>[<span class="st">'letter'</span>, <span class="st">'number'</span>])</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame([[<span class="st">'c'</span>, <span class="dv">3</span>], [<span class="st">'d'</span>, <span class="dv">4</span>]],</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                   columns<span class="op">=</span>[<span class="st">'letter'</span>, <span class="st">'number'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="merge" class="level3">
<h3 class="anchored" data-anchor-id="merge">Merge</h3>
<p>There are so many options for merging data frames using <code>pd.merge(left, right, on=..., how=...</code> that we wonâ€™t be able to cover them all here. The most important features are: the two data frames to be merged, what variables (aka keys) to merge on (and these can be indexes) via <code>on=</code>, and <em>how</em> to do the merge (eg left, right, outer, inner) via <code>how=</code>. This diagram shows an example of a merge using keys from the left-hand data frame:</p>
<p><img src="https://pandas.pydata.org/docs/_images/08_merge_left.svg" class="img-fluid"></p>
<p>The <code>how=</code> keyword works in the following ways: - <code>how='left'</code> uses keys from the left data frame only to merge. - <code>how='right'</code> uses keys from the right data frame only to merge. - <code>how='inner'</code> uses keys that appear in both data frames to merge. - <code>how='outer'</code> uses the cartesian product of keys in both data frames to merge on.</p>
<p>Letâ€™s see examples of some of these:</p>
<div id="5325684b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>left <span class="op">=</span> pd.DataFrame(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"key1"</span>: [<span class="st">"K0"</span>, <span class="st">"K0"</span>, <span class="st">"K1"</span>, <span class="st">"K2"</span>],</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"key2"</span>: [<span class="st">"K0"</span>, <span class="st">"K1"</span>, <span class="st">"K0"</span>, <span class="st">"K1"</span>],</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"A"</span>: [<span class="st">"A0"</span>, <span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>],</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"B"</span>: [<span class="st">"B0"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>],</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>right <span class="op">=</span> pd.DataFrame(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"key1"</span>: [<span class="st">"K0"</span>, <span class="st">"K1"</span>, <span class="st">"K1"</span>, <span class="st">"K2"</span>],</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"key2"</span>: [<span class="st">"K0"</span>, <span class="st">"K0"</span>, <span class="st">"K0"</span>, <span class="st">"K0"</span>],</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"C"</span>: [<span class="st">"C0"</span>, <span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>],</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"D"</span>: [<span class="st">"D0"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span>],</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Right merge</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>pd.merge(left, right, on<span class="op">=</span>[<span class="st">"key1"</span>, <span class="st">"key2"</span>], how<span class="op">=</span><span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>K0</td>
<td>K0</td>
<td>A0</td>
<td>B0</td>
<td>C0</td>
<td>D0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>K1</td>
<td>K0</td>
<td>A2</td>
<td>B2</td>
<td>C1</td>
<td>D1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>K1</td>
<td>K0</td>
<td>A2</td>
<td>B2</td>
<td>C2</td>
<td>D2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>K2</td>
<td>K0</td>
<td>NaN</td>
<td>NaN</td>
<td>C3</td>
<td>D3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the key combination of K2 and K0 did not exist in the left-hand data frame, and so its entries in the final data frame are NaNs. But it <em>does</em> have entries because we chose the keys from the right-hand data frame.</p>
<p>What about an inner merge?</p>
<div id="b396f5b5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pd.merge(left, right, on<span class="op">=</span>[<span class="st">"key1"</span>, <span class="st">"key2"</span>], how<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>K0</td>
<td>K0</td>
<td>A0</td>
<td>B0</td>
<td>C0</td>
<td>D0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>K1</td>
<td>K0</td>
<td>A2</td>
<td>B2</td>
<td>C1</td>
<td>D1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>K1</td>
<td>K0</td>
<td>A2</td>
<td>B2</td>
<td>C2</td>
<td>D2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now we see that the combination K2 and K0 are excluded because they didnâ€™t exist in the overlap of keys in both data frames.</p>
<p>Finally, letâ€™s take a look at an outer merge that comes with some extra info via the <code>indicator</code> keyword:</p>
<div id="2ca71547" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pd.merge(left, right, on<span class="op">=</span>[<span class="st">"key1"</span>, <span class="st">"key2"</span>], how<span class="op">=</span><span class="st">"outer"</span>, indicator<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">key1</th>
<th data-quarto-table-cell-role="th">key2</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">_merge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>K0</td>
<td>K0</td>
<td>A0</td>
<td>B0</td>
<td>C0</td>
<td>D0</td>
<td>both</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>K0</td>
<td>K1</td>
<td>A1</td>
<td>B1</td>
<td>NaN</td>
<td>NaN</td>
<td>left_only</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>K1</td>
<td>K0</td>
<td>A2</td>
<td>B2</td>
<td>C1</td>
<td>D1</td>
<td>both</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>K1</td>
<td>K0</td>
<td>A2</td>
<td>B2</td>
<td>C2</td>
<td>D2</td>
<td>both</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>K2</td>
<td>K0</td>
<td>NaN</td>
<td>NaN</td>
<td>C3</td>
<td>D3</td>
<td>right_only</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>K2</td>
<td>K1</td>
<td>A3</td>
<td>B3</td>
<td>NaN</td>
<td>NaN</td>
<td>left_only</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now we can see that the products of all key combinations are here. The <code>indicator=True</code> option has caused an extra column to be added, called â€™_mergeâ€™, that tells us which data frame the keys on that row came from.</p>
</section>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">Exercise</h3>
<p>Merge the following two data frames using the <code>left_on</code> and <code>right_on</code> keyword arguments to specify a join on <code>lkey</code> and <code>rkey</code> respectively:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'lkey'</span>: [<span class="st">'foo'</span>, <span class="st">'bar'</span>, <span class="st">'baz'</span>, <span class="st">'foo'</span>],</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'value'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>]})</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'rkey'</span>: [<span class="st">'foo'</span>, <span class="st">'bar'</span>, <span class="st">'baz'</span>, <span class="st">'foo'</span>],</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'value'</span>: [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2">Exercise</h3>
<p>Merge the following two data frames on <code>"a"</code> using <code>how="left"</code> as a keyword argument:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'a'</span>: [<span class="st">'foo'</span>, <span class="st">'bar'</span>], <span class="st">'b'</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'a'</span>: [<span class="st">'foo'</span>, <span class="st">'baz'</span>], <span class="st">'c'</span>: [<span class="dv">3</span>, <span class="dv">4</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What do you notice about the position <code>.loc[1, "c"]</code> in the merged data frame?</p>
<p>For more on the options for merging, see <strong>pandas</strong>â€™ comprehensive <a href="https://pandas.pydata.org/docs/user_guide/merging.html#database-style-dataframe-or-named-series-joining-merging">merging documentation</a>.</p>
</section>
</section>
<section id="introduction-to-sql-joins" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-sql-joins">Introduction to SQL Joins</h2>
<p>SQL joins are used to combine rows from two or more tables based on a related column between them. Understanding joins is crucial for effective data retrieval and manipulation. This section will cover the four main types of joins: INNER JOIN, LEFT JOIN, RIGHT JOIN, and FULL JOIN, using visual aids and code snippets with a fake data frame.</p>
</section>
<section id="types-of-joins" class="level2">
<h2 class="anchored" data-anchor-id="types-of-joins">Types of Joins</h2>
<section id="inner-join" class="level3">
<h3 class="anchored" data-anchor-id="inner-join">INNER JOIN</h3>
<p>An INNER JOIN returns only the rows that have matching values in both tables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/Inner_JOIN.png" class="img-fluid figure-img"></p>
<figcaption>INNER JOIN</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Inner join example</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  A.<span class="kw">id</span>, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  A.name, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  B.order_id</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  Customers A</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  Orders B <span class="kw">ON</span> A.<span class="kw">id</span> <span class="op">=</span> B.customer_id;</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="left-join" class="level3">
<h3 class="anchored" data-anchor-id="left-join">LEFT JOIN</h3>
<p>A LEFT JOIN returns all the rows from the left table and the matched rows from the right table. If no match is found, NULL values are returned for columns from the right table.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/Left_JOIN.png" class="img-fluid figure-img"></p>
<figcaption>LEFT JOIN</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Left join example</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  A.<span class="kw">id</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  A.name, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  B.order_id</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  Customers A</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  Orders B <span class="kw">ON</span> A.<span class="kw">id</span> <span class="op">=</span> B.customer_id;</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="right-join" class="level3">
<h3 class="anchored" data-anchor-id="right-join">RIGHT JOIN</h3>
<p>A RIGHT JOIN returns all the rows from the right table and the matched rows from the left table. If no match is found, NULL values are returned for columns from the left table.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/Right_JOIN.png" class="img-fluid figure-img"></p>
<figcaption>RIGHT JOIN</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  A.<span class="kw">id</span>, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  A.name, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  B.order_id</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  Customers A</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  Orders B <span class="kw">ON</span> A.<span class="kw">id</span> <span class="op">=</span> B.customer_id;</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="full-join" class="level3">
<h3 class="anchored" data-anchor-id="full-join">FULL JOIN</h3>
<p>A FULL JOIN returns all the rows when there is a match in either left or right table. Rows without a match in one of the tables will contain NULL values for columns from that table.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/full-join.png" class="img-fluid figure-img"></p>
<figcaption>FULL JOIN</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Full join example</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="ot">"""</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  A.<span class="kw">id</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  A.name, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  B.order_id</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  Customers A</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FULL</span> <span class="kw">JOIN</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  Orders B <span class="kw">ON</span> A.<span class="kw">id</span> <span class="op">=</span> B.customer_id;</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="ot">"""</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(p, con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="example-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="example-data-frames">Example Data Frames</h2>
<p>To illustrate these joins, letâ€™s consider two fake data frames: <code>Customers</code> and <code>Orders</code>.</p>
<div id="7f5861c7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a fake data frame for Customers</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>customers <span class="op">=</span> pd.DataFrame({</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'id'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'David'</span>]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a fake data frame for Orders</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>orders <span class="op">=</span> pd.DataFrame({</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'order_id'</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>],</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'customer_id'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the data frames</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Customers Data Frame"</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(customers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Customers Data Frame
   id     name
0   1    Alice
1   2      Bob
2   3  Charlie
3   4    David</code></pre>
</div>
</div>
<div id="a09d116a" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Orders Data Frame"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Orders Data Frame
   order_id  customer_id
0       101            1
1       102            2
2       103            2
3       104            4</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>SQL is an indispensable tool for anyone working with data. Its ability to manage, manipulate, and integrate data makes it essential for data analysis and decision-making. The examples provided in this chapter illustrate some of the key operations and techniques used in SQL, highlighting its importance in the field of data science.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/byuidatascience\.github\.io\/DS250-Course-Draft\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>J. Hathaway, Chaz Clark BYU-I 2024Â©</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/byuistats/DS250-Course/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/byuidatascience">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/groups/13537407/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>